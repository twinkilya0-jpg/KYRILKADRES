-- Floating Button & Loader (By:Carryxkn2)
if not game:IsLoaded() then game.Loaded:Wait() end

local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")

-- Ссылка на твой чит
local ScriptURL = "https://raw.githubusercontent.com/twinkilya0-jpg/KYRILKADRES/refs/heads/main/DRESS.TXT"

-- /////////////////////////////////////////////////////////////
-- //               СОЗДАНИЕ КНОПКИ                           //
-- /////////////////////////////////////////////////////////////

local openshit = Instance.new("ScreenGui")
openshit.Name = "openshit"
openshit.Parent = LocalPlayer:WaitForChild("PlayerGui")
openshit.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
openshit.ResetOnSpawn = false

local mainopen = Instance.new("TextButton")
mainopen.Name = "mainopen"
mainopen.Parent = openshit
mainopen.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
mainopen.BackgroundTransparency = 1
mainopen.Position = UDim2.new(0.1, 0, 0.15, 0)
mainopen.Size = UDim2.new(0, 64, 0, 42)
mainopen.Text = ""

local mainopens = Instance.new("UICorner")
mainopens.Parent = mainopen

local AssetsIcon = "rbxassetid://103822431806952"
local AssetsBackground = "rbxassetid://95198449172379"

local backgroundImage = Instance.new("ImageLabel")
backgroundImage.Name = "RotatingBackground"
backgroundImage.Parent = mainopen
backgroundImage.Size = UDim2.new(1.9, 0, 1.9, 0)
backgroundImage.Position = UDim2.new(0.5, 0, 0.5, 0)
backgroundImage.AnchorPoint = Vector2.new(0.5, 0.5)
backgroundImage.BackgroundTransparency = 1
backgroundImage.Image = AssetsBackground
backgroundImage.SizeConstraint = Enum.SizeConstraint.RelativeXX
backgroundImage.ZIndex = 0

local frontImage = Instance.new("ImageLabel")
frontImage.Name = "StaticIcon"
frontImage.Parent = mainopen
frontImage.Size = UDim2.new(0.8, 0, 1, 0)
frontImage.Position = UDim2.new(0.5, 0, 0.5, 0)
frontImage.AnchorPoint = Vector2.new(0.5, 0.5)
frontImage.BackgroundTransparency = 1
frontImage.Image = AssetsIcon
frontImage.ZIndex = 1

local frontCorner = Instance.new("UICorner")
frontCorner.CornerRadius = UDim.new(1, 0)
frontCorner.Parent = frontImage

-- Вращение
local rotation = 0
local speed = 90 
local lastTime = tick()
task.spawn(function()
    while true do
        local now = tick()
        local delta = now - lastTime
        lastTime = now
        rotation = (rotation + speed * delta) % 360
        backgroundImage.Rotation = rotation
        task.wait()
    end
end)

-- Перетаскивание
local function MakeDraggable(topbarobject, object)
    local Dragging, DragInput, DragStart, StartPosition
    topbarobject.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = true
            DragStart = input.Position
            StartPosition = object.Position
            input.Changed:Connect(function()
                if input.UserInputState == Enum.UserInputState.End then Dragging = false end
            end)
        end
    end)
    topbarobject.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then DragInput = input end
    end)
    UserInputService.InputChanged:Connect(function(input)
        if input == DragInput and Dragging then
            local delta = input.Position - DragStart
            object.Position = UDim2.new(StartPosition.X.Scale, StartPosition.X.Offset + delta.X, StartPosition.Y.Scale, StartPosition.Y.Offset + delta.Y)
        end
    end)
end
MakeDraggable(mainopen, mainopen)

-- /////////////////////////////////////////////////////////////
-- //               ЛОГИКА ВЗАИМОДЕЙСТВИЯ                     //
-- /////////////////////////////////////////////////////////////

local scriptExecuted = false

mainopen.MouseButton1Click:Connect(function()
    -- 1. Эффект ускорения при нажатии
    task.spawn(function()
        speed = 400
        task.wait(0.4)
        speed = 90
    end)

    -- 2. Если скрипт еще не был загружен — загружаем его
    if not scriptExecuted then
        scriptExecuted = true
        pcall(function()
            loadstring(game:HttpGet(ScriptURL))()
        end)
        return -- После первой загрузки меню обычно открывается само
    end

    -- 3. Если скрипт уже работает — управляем его видимостью
    -- Пытаемся найти окно в глобальной переменной _G.Window
    if _G.Window then
        _G.Window:Minimize()
    else
        -- Если автор скрипта не вынес Window в _G, попробуем загрузить еще раз
        pcall(function()
            loadstring(game:HttpGet(ScriptURL))()
        end)
    end
end)
