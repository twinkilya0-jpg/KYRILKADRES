local Players = game:GetService("Players")
local LocalPlayer = Players.LocalPlayer
local UserInputService = game:GetService("UserInputService")
local RunService = game:GetService("RunService")
local SoundService = game:GetService("SoundService")

-- [!] ЗАГРУЗКА БИБЛИОТЕКИ FLUENT
local Fluent = loadstring(game:HttpGet("https://github.com/dawid-scripts/Fluent/releases/latest/download/main.lua"))()

local Window = Fluent:CreateWindow({
    Title = "Script for Dress To impress",
    SubTitle = "By:Carryxkn2",
    TabWidth = 160,
    Size = UDim2.fromOffset(580, 460),
    Acrylic = false,
    Theme = "Dark",
    MinimizeKey = Enum.KeyCode.LeftControl
})

-- === НАСТРОЙКИ ТВОЕЙ КНОПКИ ===
local SizeBackMulti = 0.1
local AssetsIcon = "rbxassetid://103822431806952"
local AssetsBackground = "rbxassetid://95198449172379"

local openshit = Instance.new("ScreenGui")
openshit.Name = "openshit"
openshit.Parent = LocalPlayer:WaitForChild("PlayerGui")
openshit.ZIndexBehavior = Enum.ZIndexBehavior.Sibling
openshit.ResetOnSpawn = false

local mainopen = Instance.new("TextButton")
mainopen.Name = "mainopen"
mainopen.Parent = openshit
mainopen.BackgroundColor3 = Color3.fromRGB(35, 35, 35)
mainopen.BackgroundTransparency = 1
mainopen.Position = UDim2.new(0.1, 0, 0.1, 0)
mainopen.Size = UDim2.new(0, 60, 0, 60)
mainopen.Text = ""

local mainopens = Instance.new("UICorner")
mainopens.CornerRadius = UDim.new(1, 0)
mainopens.Parent = mainopen

local backgroundImage = Instance.new("ImageLabel")
backgroundImage.Name = "RotatingBackground"
backgroundImage.Parent = mainopen
backgroundImage.Size = UDim2.new(1.8 + SizeBackMulti, 0, 1.8 + SizeBackMulti, 0)
backgroundImage.Position = UDim2.new(0.5, 0, 0.5, 0)
backgroundImage.AnchorPoint = Vector2.new(0.5, 0.5)
backgroundImage.BackgroundTransparency = 1
backgroundImage.Image = AssetsBackground
backgroundImage.SizeConstraint = Enum.SizeConstraint.RelativeXX
backgroundImage.ZIndex = 0

local frontImage = Instance.new("ImageLabel")
frontImage.Name = "StaticIcon"
frontImage.Parent = mainopen
frontImage.Size = UDim2.new(0.8, 0, 0.8, 0)
frontImage.Position = UDim2.new(0.5, 0, 0.5, 0)
frontImage.AnchorPoint = Vector2.new(0.5, 0.5)
frontImage.BackgroundTransparency = 1
frontImage.Image = AssetsIcon
frontImage.ZIndex = 1

local frontCorner = Instance.new("UICorner")
frontCorner.CornerRadius = UDim.new(1, 0)
frontCorner.Parent = frontImage

-- === ВРАЩЕНИЕ ===
local rotation = 0
local speed = 90 
local lastTime = tick()

task.spawn(function()
    while true do
        local now = tick()
        local delta = now - lastTime
        lastTime = now
        rotation = (rotation + speed * delta) % 360
        backgroundImage.Rotation = rotation
        task.wait()
    end
end)

-- === ПЕРЕТАСКИВАНИЕ ===
local function MakeDraggable(topbarobject, object, locked)
    local Dragging, DragInput, DragStart, StartPosition
    local Holding = false
    local HoldTime = 1.0
    local MoveCancelThreshold = 6
    local HoldToken = 0
    object:SetAttribute("Locked", locked or false)
    local function Update(input)
        if object:GetAttribute("Locked") then return end
        local delta = input.Position - DragStart
        object.Position = UDim2.new(StartPosition.X.Scale, StartPosition.X.Offset + delta.X, StartPosition.Y.Scale, StartPosition.Y.Offset + delta.Y)
    end
    topbarobject.InputBegan:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then
            Dragging = not object:GetAttribute("Locked")
            Holding = true
            DragStart = input.Position
            StartPosition = object.Position
            HoldToken += 1
            local token = HoldToken
            task.delay(HoldTime, function()
                if Holding and token == HoldToken then
                    local newState = not object:GetAttribute("Locked")
                    object:SetAttribute("Locked", newState)
                end
            end)
        end
    end)
    topbarobject.InputChanged:Connect(function(input)
        if input.UserInputType == Enum.UserInputType.MouseMovement or input.UserInputType == Enum.UserInputType.Touch then
            if DragStart and (input.Position - DragStart).Magnitude > MoveCancelThreshold then Holding = false end
            DragInput = input
        end
    end)
    UserInputService.InputChanged:Connect(function(input) if input == DragInput and Dragging then Update(input) end end)
    UserInputService.InputEnded:Connect(function(input) if input.UserInputType == Enum.UserInputType.MouseButton1 or input.UserInputType == Enum.UserInputType.Touch then Dragging = false Holding = false end end)
end
MakeDraggable(mainopen, mainopen, false)

-- === ЗВУКИ И КЛИК ===
local function playSound(soundId)
    local sound = Instance.new("Sound")
    sound.SoundId = "rbxassetid://" .. soundId
    sound.Parent = SoundService
    sound:Play()
    sound.Ended:Connect(function() sound:Destroy() end)
end

mainopen.MouseButton1Click:Connect(function()
    local sounds = { "7127123605", "137566474343039", "438666542" }
    playSound(sounds[math.random(#sounds)])
    if Window then Window:Minimize() end
end)

-- === ФУНКЦИИ ===
local Tabs = {
    Main = Window:AddTab({ Title = "Игрок", Icon = "user" }),
    Farm = Window:AddTab({ Title = "Автофарм", Icon = "shovels" })
}

local tpwalk_speed = 0
local noclip_enabled = false

-- Функция сбора
local function CollectCoins()
    for _, obj in pairs(workspace:GetDescendants()) do
        if (obj.Name:find("Coin") or obj.Name:find("Token") or obj.Name:find("Money")) and obj:IsA("BasePart") then
            if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") then
                LocalPlayer.Character.HumanoidRootPart.CFrame = obj.CFrame
                task.wait(0.12)
            end
        end
    end
end

-- === ГЛАВНЫЙ ЦИКЛ (TPWALK + NOCLIP) ===
RunService.Stepped:Connect(function()
    if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("HumanoidRootPart") and LocalPlayer.Character:FindFirstChild("Humanoid") then
        local hrp = LocalPlayer.Character.HumanoidRootPart
        local hum = LocalPlayer.Character.Humanoid

        -- TPWalk
        if tpwalk_speed > 0 and hum.MoveDirection.Magnitude > 0 then
            hrp.CFrame = hrp.CFrame + (hum.MoveDirection * (tpwalk_speed / 10))
        end

        -- Noclip
        if noclip_enabled then
            for _, part in pairs(LocalPlayer.Character:GetDescendants()) do
                if part:IsA("BasePart") then part.CanCollide = false end
            end
        end
    end
end)

-- === ВКЛАДКА ИГРОК ===
Tabs.Main:AddInput("TPW", {
    Title = "TPWalk Speed (Обход)",
    Default = "0",
    Callback = function(v) tpwalk_speed = tonumber(v) or 0 end
})

Tabs.Main:AddToggle("NoclipTog", {
    Title = "Проход сквозь стены (Noclip)",
    Default = false,
    Callback = function(v) noclip_enabled = v end
})

Tabs.Main:AddInput("JP", {
    Title = "Прыжок", 
    Default = "50", 
    Callback = function(v) 
        if LocalPlayer.Character and LocalPlayer.Character:FindFirstChild("Humanoid") then
            LocalPlayer.Character.Humanoid.JumpPower = tonumber(v) or 50
        end
    end
})

-- === ВКЛАДКА АВТОФАРМ ===
Tabs.Farm:AddButton({
    Title = "Собрать все монеты",
    Callback = function()
        CollectCoins()
    end
})

Window:SelectTab(1)
